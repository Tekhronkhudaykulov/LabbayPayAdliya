import{r as a,u as N,a as j,j as s,A as c}from"./index-2c8e8237.js";import{A as E}from"./assets-8ecff1c4.js";import{N as v}from"./view-0e859999.js";import{L as S}from"./view-0a6af2b1.js";import{m as b,e as y}from"./endpoints-a705306d.js";import{u as _}from"./useCustomPost-ccc383b8.js";const Q=()=>{const[o,l]=a.useState(60);a.useState("");const r=a.useRef(null),n=N(),{setResponseData:P,setError:m,error:u}=j();a.useEffect(()=>{if(o===0){n("/");return}const e=setTimeout(()=>l(t=>t-1),1e3);return()=>clearTimeout(e)},[o]),a.useEffect(()=>{const e=()=>{var t;return(t=r.current)==null?void 0:t.focus()};return e(),window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[]);const d=e=>{try{return JSON.parse(e),!0}catch{return!1}},x=e=>{const t=e.target.value.trim();d(t)&&(h(JSON.parse(t)),e.target.value="")},{mutate:p,isPending:f,isError:g}=_({onSuccess:async()=>{n(`${c.PAYMENT_OF_FINE}/${c.PAYMENT_OF_FINE_CASH}`)},onError:e=>{var t,i;console.log(e,"error"),m((i=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:i.message)}}),h=e=>{p({endpoint:y.payQr,body:{s_id:Number(e.s_id),p_acc:e.p_acc}})};return s.jsxs(s.Fragment,{children:[f&&s.jsx(S,{}),g&&s.jsx(v,{message:u,onClose:""}),s.jsxs(b.div,{className:"h-full flex flex-col gap-[30px] p-[70px]",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0,y:-30},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeInOut"}}},children:[s.jsxs("div",{className:"grid grid-cols-[1fr_1fr] gap-[45px]",children:[s.jsxs("div",{className:"flex flex-col gap-[27px]",children:[s.jsx("h2",{className:"text-[50px] font-bold",children:"ОТСКАНИРУЙТЕ КОД"}),s.jsx("hr",{className:"border-[#5960FE]"}),s.jsx("h2",{className:"text-[50px] font-bold",children:"Инструкция"}),s.jsx("p",{className:"text-[32px] font-medium",children:"1. Поднесите QR/Штрих код к сканеру"}),s.jsx("p",{className:"text-[32px] font-medium",children:"2. Зелёная метка сканера должна попасть на QR/Штрих код"}),s.jsx("p",{className:"text-[32px] font-medium",children:"3. Если хотите ввести номер квитанции вручную или выйти на экран оплаты, то, нажмите на кнопку “Закрыть”"}),s.jsx("input",{ref:r,type:"text",onChange:x,className:"absolute opacity-0 -z-10",autoFocus:!0})]}),s.jsx("div",{children:s.jsx("img",{src:E.QrPageImg,alt:"QR scan instruction"})})]}),s.jsxs("button",{onClick:()=>n("/"),className:"bg-[#C82E2E] text-[28px] mt-auto py-[40px] rounded-[16px] text-white w-[80%] mx-auto",children:["Закрыть (",o,")"]})]})]})};export{Q as default};
